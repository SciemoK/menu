<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Digital Menu</title>
    <link rel="stylesheet" href="style.css">
    <script src="https://unpkg.com/@lottiefiles/lottie-player@latest/dist/lottie-player.js"></script>
</head>
<body>

    <div id="main-container">

        <div id="animation-page" class="page">
            <lottie-player 
                id="introLottie"
                src="assets/welcome.json" 
                speed="1" 
                style="width: 100%; height: 100%; object-fit: cover;"
                autoplay>
            </lottie-player>
        </div>

        <div id="language-page" class="page">
            <div class="menu-pill-container">
                <button class="lang-btn active" onclick="selectLang('it')">BAR</button>
                <button class="lang-btn" onclick="selectLang('en')">EN</button>
                <button class="lang-btn" onclick="selectLang('de')">DE</button>
            </div>
        </div>

        <div id="page-overlay" onclick="toggleFooter()"></div>

        <div id="mountain-footer">
            <div class="footer-trigger" onclick="toggleFooter()">
                <div id="footer-arrow">↑</div>
            </div>
            </div>

    </div>

    <script>
        const player = document.querySelector("#introLottie");
        const animPage = document.getElementById("animation-page");
        const langPage = document.getElementById("language-page");
        const footer = document.getElementById("mountain-footer");
        const overlay = document.getElementById('page-overlay');
        const arrow = document.getElementById('footer-arrow');

        /* TIMING 1: TRIGGER MOUNTAIN ENTRANCE 
           This happens while the animation is still playing.
           Adjust 2000 (2 seconds) to match your animation sweet spot.
        */
        setTimeout(() => {
            footer.classList.add("visible");
        }, 2000); 

        /* TIMING 2: ANIMATION ENDS 
           Transition from the video to the language buttons.
        */
        player.addEventListener("complete", () => {
            animPage.style.opacity = "0";
            
            setTimeout(() => {
                animPage.style.display = "none";
                langPage.style.display = "flex";
                
                // Trigger fade-in for buttons
                setTimeout(() => { 
                    langPage.style.opacity = "1"; 
                }, 50);
            }, 600);
        });

        /* INTERACTION: FOOTER OPEN/CLOSE 
           Handles the blur, the mountain slide, and the arrow rotation.
        */
        function toggleFooter() {
            if (!footer.classList.contains('open')) {
                // OPENING
                footer.classList.add('open');
                overlay.style.display = 'block';
                setTimeout(() => { overlay.style.opacity = '1'; }, 10);
                arrow.innerHTML = '✕';
            } else {
                // CLOSING
                footer.classList.remove('open');
                overlay.style.opacity = '0';
                setTimeout(() => { 
                    overlay.style.display = 'none'; 
                }, 400);
                arrow.innerHTML = '↑';
            }
        }

        /* LANGUAGE SELECTION 
           Placeholder for your next step!
        */
        function selectLang(lang) {
            // 1. Show the mountain peaks (Peeking state)
            footer.classList.add("visible");

            // 2. Set the correct footer image based on language
            if (lang === 'it') {
                footer.style.backgroundImage = "url('images/footer-it.png')";
            } else if (lang === 'en') {
                footer.style.backgroundImage = "url('images/footer-en.png')";
            } else if (lang === 'de') {
                footer.style.backgroundImage = "url('images/footer-deutsch.png')";
            }

            // 3. Jump to the Italian Menu
            // This looks for the 'ita' folder, then 'digital-menu' folder, then the pizzeria.html
            setTimeout(() => {
                window.location.href = "bar.html";
            }, 600); // Slight delay so the user sees the button click/footer rise
        }
    </script>
</body>
</html>